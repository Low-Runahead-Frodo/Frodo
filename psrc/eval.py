from memory import MemoryReader
import numpy as np
from hash2mat import hex_string_to_matrix

reader = MemoryReader('sim/RAM/data/mem0.hex','hex')
A = reader.read_matrix(16,1344,8,8)
A = np.array(A)
# print(A)
B = reader.read_matrix(1361,1344,8,16)
B = np.array(B)
#print(B)

reader_1 = MemoryReader('sim/RAM/data/mem1.hex','hex')
C = reader_1.read_matrix(100,8,8,16)
C = np.array(C)
# print(C)

reader_2 = MemoryReader('sim/mem1_result.hex','hex')
D = reader_2.read_matrix(100,8,8,16)
D = np.array(D)
print(D)
#print(B[0])
# result = np.matmul(B[0].reshape((8,1)),[A[0]]) + C
#result = B.T @ A + C
result = np.matmul(B.T,A)+C
# print(result)
# print(result==D)

# reader_2 = MemoryReader('sim/mem0_result.hex','hex')
# C_T = reader_2.read_matrix(16,8,8,16)
# C_T = np.array(C_T)
# print(C_T)
# print(C_T==C.T)


string = "fb3ecd955f51cb1cb2679557a2eea4c01a81d670f1ee721ed3953d218604a72f5ed3b41f4834edf054810f96128a63e9d8dc60a490713e2fe44064b0d17ddc9fc866c86bacff830d5df1c977a472cd9d46f89dc42ba848554af3025f861bc423a5b58899d745113cc9d3c0fc28e17fce1e9490a8ae8ae131c75e6a01b1683fb401dbf41fffefa42a2d55307f699a5a395e95be894d04d9f6a51838e24224ca11987006a76db364bb0aab9659251548f9e7b0c73dc4a812633eece196aa21a121cb899d27a1efca767627f2630aececce25c7410cd863b1dedf62813c476ab45c698d91189809d7c97ef23adde2fad16dd1c9a8354daec4776f0881ca4557d874710d120cd9a4ce47aa09591cf5cf0100ed3c4f664a74d4e5ec61d6266bc15dcf7c98615a58e45220014ae1deaedcde9cc11cf1e75d812806085bff5533ead11764ce80a0ee0f0a4dcf186ad440e2d347bdcca56c96c059bcdbf3e8220a36b3cd85b9e429e696ced6e94c28394d1f3fb4eb9de8866d6f3e9b171a16fa21e660835fadc73e084ffbd3d7660ac8e84879bffe22a38cf64cf3c3317a86517d1582155bc48e89efb3f78a346ba6e4c31ff5735f1a7799ce653ef76c4c142d121e8f4e27bd68cedec77c98fa8307692eacd3e4926311bc6d869cb839ee737fc4d1cd3cadaaa4c67cba9f451e84fd0560ddd9ad7bf79cfb50fb9928675a93d82b50dd334b7948ce8b40d8dc6fd82628af72463c6264c5daf70cefa891242b72190ae8f1b0a30e970e320c875e093a63726f6c9dc4721f01657f15edabcab40004ff6ca926e93bb06214e892a6e7876c6adeda0968fa22bf4d7fdd4f3e14f97f8db799ebfaa255cf8c596f8668bc6bb9ce63b640e8bf0598957b4aae1c10bf74c5f59f52049471ee5a8798f4ee534bf19c4cd5d85247415c08be751b72b084f552f3bc311e3e1018f7913e548212aa74f84b32eeb9fb845cc3eccdee22c5ee1e6ad30e7c1166d305228038aee91ede348ff8dd2559d38e64491d6863c63ce49971207b4c712f93a47481bc9b7cbab98900ab173d355aec2a5e086fd6739286e35e8e78887e63edee2c755e06160edf9d031b02e4623122e7d9763a9719c71ed1def332e44f06f80d93d6386ae1386421be5d4b091f1ca2caad710a58dddca68fe578f95d9855f55e93129b16fb9da943785f97f43f180a7a3b6f84430680f7e80e789348d2249e79502b992f1f3dd7e7a949bd2fbce8dfa09df1c50857b7962f63910f366bf5de4783928d61b79e9c8d3de126caf01e8491b70039dd497332439d36f368696c468508af37c50a86aba50c40661c022f051162bfeb0c101a50834635a73435cf9562bacb7802e3cbb0b3062f244b4cfbe9f3c385b839f0afe427714fc16ccc5df65e0e9601a34e363951146d7c15fd537455367ba4681ed142387584c46f5177b4112eefbcb3c25ed7ed41c0247274f9ec42238282766ebdb1718ca2bada83df144a1e48df91efb3adbb0b27941085184dbfd14116467cd03fb06f2a8b81e5df360d767525e7a03552b115364066ca1edd0228e7a5eb97c8861ab4747a108245b0916c7ebbd55c6bb599e557add379cd337f250389e42232b451cb9dd55815beb83ad7e58c63d4bde171bfa5029bb0a5f3cd11fdfc69a788973848ea7ef3975746a7385628016217511c6a6b68c0f27339659c5c0acad0d42ee187eb00db67dbfbfbcf0b8b38f1eefbe029c9846c530104b77c92621ab2793cbefdeeef8b551833778739588d7333382595b3eeab1319bf1bc1fb66d2be681a7f982fa7ac"
string2 = "21eee252a18ac567ad55f9dca3dd7c029a4ec8a3e78735194a9a5130b1042093b01229195035fba2e9d58158b6dc86cdc2ae79b47c93909e6a3461c48b0df11baeca41fc7ed1baca5927120d39ee606bed2384b691f3bdd94aa5b92a4aa9a809c3c48ae75059bb976d6c5abab3d6a5b27fe8cf29412ede7b86c62057b47b1a8e9f8602f5eb01508e60ee4116c645b521fc5504179ea32f5bd2c664f6fad5cef34dd1f8fceb5b81a5b72130296dd2783453f8a12f6acb181a187001402c8d2802e526ba371d5dbd324d61cb5178b17bfa8140160db22a8e0e49ca0fc32266310524384b07426bb373e96c845db4f47b295ca145aca83736c33ae716e865470e13bfb9d9ab7f28a5076963586b8630187fe4c45bd96fe3d236975c5b47cb06bfe3b5744e4ada3c7c1f9eb5a33da634d4a4519ab46871dba31d2751bb1b13d09c9b40f0ddea021df713dac3b90332dd8fcec408f8b21a3582b04e0f991e3c0f7c68628b32ce79c007d5140eb20163bc23d9819742aa731aa7c307a714fb771773ffc1caeb7c49acb720c9d4b6df06f788e2fe5f4cd878dbf9bc29a0f7a334557840047220902dfce738e8ae12773cd178e7ef8da473a13abcfdd52ca171dc8975e80679fa883ea8effea46e3ab3a15b08ab1ab6ba1ba3c93fbb59670d16a51440e6650b57a102d550c91b9b39fc70930c1b60f6bba95b4596e1d79ad9a60906ba6e111fdc2f010aae6eb782726011a30d07d77c64b93e83a8978bc46d9c209f3ba5469151e3d2b3788bf13647dc5a360f5be03d28981c5adf10af2338c25505e11186ccb477c1b9985be69aac0c809d93748a92c67660635523a57c029bc30304ebbbd9342d54632393d541b47519b9506abf4c726005cbda03482dc905ce21016a439b7422b20d33ab4ea7c546b6f3690b48594c89a27a65e9e56ac5e3b65ec850ebf78a627e335f9211530bc85c48f84a56870cd5f1e9fc92fdabeb81758ec3845c63eb83db87b0138ca761fd09b428444285ca05339fdf01d1b5f7bd9733e9c0e6ebb5fe7ca15dce99de574de41e5d4ed3b6fc0cb58bedde921246865b3e015d5d87b7bb001e136f1fcf5e681b8933c2e3f126f622efd001f66da92189e32379c246ee3a1913a6be0f93472e57270102b455ede98e3c708be98fc0c35a73f0f7e9dd7911284e62cf27ea9885cdc48f38f88f1e0aa546ff35297bc9b07fde344570d9f5406a9a4e7c599d32d859d8964dffcf5d3a1ff09aacbd48cb875f40a8fe97db1ee55822be7e40ce3b217d8730086e9c4220a61efdfc967c52a1eae9ee71ad8d370b7d0a8aee89a9ce640a06827a0917e6877e183c961fc419a6d91b86a5456945eddf5b807415d44b5cd5e21681da797a9d9313005a0bb2284fa6d7b2831b3ac48532e8880ac34cab0eaf44231411eb98dab8a5c895700c34b81351ca180406bc87879fe7a138a18473632f97bd641b582d68d8cb9752b11b6f84f6a665d41a5c7d4378402198ab1a86b37e8cc410b93c18c40572367a7fedd3f6983e443a60798d810ccb31596946ef5b666ed5bd1f48be87bf58455f5d0f16e6f3637c0e8a706e5204e5ed8ebe2e66dc7fd01203397c5d5277f3bc87d99015e1f9aa79d9610facc1a7ec34cd9f24a3485159dcfa4bb8702092ebeae31ed456540e312cb0c8de7ba4956460a28faf8ad30cb362fc2fd98efd8fb7f105bbfab8205bc7f9247cbe17b711f297eacfb40aa9bd25d89fc62fedf719c1fa732c476241b0de0e9257be2058bf7c0614d468a96ce5d47ba829fc74a1bc69ff78de1a1fe6336914dfaf3ee288e84b434277718b64c01a37c7af9140a66e5893b5b8565d67c2e30acc7fb009550e08e3abfe404ecd57cab3b5eae28d709c72950530cf724abe118e0364c6e0db1bd98aa8bcc3fd891d08454bf94a2e60ceaa81fbd29a5836d9a8239213f87c9edecc0c4ebdfba761fb0965953635b8d620fbe83c855053b4373c9588eede42f1a6e70d4bbd79eccc5728bb41b34aff73626d696169964f026965e243a836bdc5a70ee92d67333cf7447f36805475070f2a4bfd03711e4499fd8bcd20ad1ab3163e69540ef74e196dbdc0e7fdacf9ecca58b137ebe338b6ccf8b0f6f445308f10dc5f9904ed9061cc3ef8b3922cc011d490e9d19d7e47ee8650b401ec1e2b9b80dcbf912fd82fe1630c49ff1e654612dd6a93704d2843a8f8f14b58409c4c6f071984c4ce81c8ed05ef17f48e56a5a71ab3b3bece3436d4b4606fc20b31972b8fe1d67647c188e38039df2e06421b3d955897e2eb116f297dbc913a8657ce10ef1d5d75e89346fcae4e89dcdfbf2e02de99dbb2b28ab8a415dc0a6aaaa0ef68b78b538f2b18328bbaeea476e799be37eb6471316a88da02ef604942139aca453fa349e06cdd007e8ec1d53c9c9375597d1b84787f7c61591ad17f4f997e91f7d95fc281c064508d954cbb5968e3c7bdf0b3433b86d17bbfc2e63a1a19f6d97c95b3513be5126bcfe4936ec70b5404b4605ff18ab89619cd7707f1a17f52dca67fae80703dd3246017124726972103dda84855b1195861ac2b65984108c251a54ad76dc1c0d5f4af5d9ec19a90906634d9da235e7a965d29ea9f4017e55a738ca1eaf6896cbf455f66f7915981cd4e8ceef55c46227738dbe1dd6eacea4d40d92bf508b427d79422cfbafa75f53ff9c407fba37c72431fadf0300a634d61eada2ab284c874f8897f4ea7047e4a756f33d23eccc7314d7702a34ac793f9876125ecd7fcdf370804c1c93f967a945959a8af04defdb111813b72523718ddb3046a3733eb257f334c55600708bf78aa3fd4420b77babc6c909aa30afc9f0709f79b6c78be1dabccffacdf82d2520c5280c06ed7dd103d5f51b283cea22076668dbd5383b063bd1bfe9a58e13f0b8c323623f58228ee9a80a031c87137f2e2586fde6c90882cd2463da04b14d80fad1636648dfe9dd44f44578bf4289335b62431386f507eee4ffb65740210da4c6f9ab802a345f7d0047d7ee0a7494d9e6809456e44a603b45352eb8d95b5d27fb1c0f744007af8c5cbd5ee2f7cd524dd3b32ec191fc41c8b93284636b3fb515a8f86aa784a37ca5d5ab100c0840814a49f340c80997125f784d14cb9715fa863924909cfded9f41c33c0262a39628a374ad57029512e1b02d431524269f1cecb520356fe504eb02b2c6c39ce8a7d96fa5004cb1a537aa06d0ab45e14c2d77819ffbb249de045aff8119606e53318ab5e3458c3baa101b540f17fe1d3aa0993c466d4f502919277eec555614fb0e9154995263c1f40957600708f13686fe23b732729fdc0bb407bd19a551ce3ac4305e8a58b742f8a3c0dc57f5a56210487a3d70e144c325206dd530cb0c25bcd34fe8f0cfa7c218db990d4fd119dbbca336f36164c946cc134acb731e9d4f1bcf96dddad2c34c21ef01c940af2d728e109e56a34887c897d5e6e57033873733eaa171629b6feda88b36db1b6f74277b2a9d76f852ff2cd6bf40352f8a320b95e3080d4f9bb3726fc996b96513ea5e40d2426d251901568b625783c103f3888d8e0e2f00de6b46031d2c5f83a10786d3978090ec567c392dd1d0923ae2497f1003e867ee0aa40a1dec1431dfe4176f0fa1b65aa372cedc40442d9e5f23a89911ac5d0130e2c85fc31d9e9c2bc81e5d5f4b3337c2dff855925fd6a28bbd1cbd4da5ff10e4e9715db4e89eb45333ba72ed763b80900ac056c55e42dd7345eac5d920319b7630bc76d06263f3a1a15f0004769b0d54551f5007386fb8473ddc2a097873d7f"
mat = hex_string_to_matrix(string,rows=1)
#print(mat)
mat2 = hex_string_to_matrix(string2,rows=1)
temp = [0,0,0,0,0,0,0,0]
for i in range(640):
    for j in range(8):
        # print(mat[0][i],A[i][j])
        temp[j] = temp[j] + mat[0][i]*A[i][j]
        temp[j] = temp[j]%65536

print(temp)
temp = [0,0,0,0,0,0,0,0]
for i in range(1344):
    for j in range(8):
        # print(mat[0][i],A[i][j])
        temp[j] = temp[j] + mat2[0][i]*A[i][j]
        temp[j] = temp[j]%65536

print(temp)